<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mark’s Handy Dandy JSON Viewer</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 2rem 0;
        }
        .table-responsive {
        	margin-top: .5rem;
        	}
        .drop-zone {
            border: 3px dashed #dee2e6;
            border-radius: 10px;
            padding: 3rem;
            text-align: center;
            background: white;
            transition: all 0.3s;
            cursor: pointer;
        }
        .drop-zone:hover, .drop-zone.dragover {
            border-color: #667eea;
            background: #f8f9fa;
            transform: scale(1.02);
        }
        .json-display {
            background: white;
            border-radius: 10px;
            padding: 2rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .json-key {
            color: #111111;
            font-weight: bold;
        }
        .json-value {
            color: #333;
        }
        .json-string { color: #333333; }
        .json-number { color: #333333; }
        .json-boolean { color: #dc3545; }
        .json-null { color: #6c757d; font-style: italic; }
        pre {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 5px;
            border-left: 4px solid #667eea;
            max-height: 600px;
            overflow: auto;
        }
        .badge-custom {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="row mb-4">
            <div class="col-12 text-center">
                <h1 class="text-white fw-bold mb-2">Mark’s Handy Dandy JSON Viewer</h1>
                <p class="text-white-50">Drop your JSON file or click to browse</p>
            </div>
        </div>

        <div class="row mb-4">
            <div class="col-12">
                <div class="drop-zone" id="dropZone">
                    <input type="file" id="fileInput" accept=".json" style="display: none;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" fill="#667eea" class="bi bi-cloud-upload mb-3" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M4.406 1.342A5.53 5.53 0 0 1 8 0c2.69 0 4.923 2 5.166 4.579C14.758 4.804 16 6.137 16 7.773 16 9.569 14.502 11 12.687 11H10a.5.5 0 0 1 0-1h2.688C13.979 10 15 8.988 15 7.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 2.825 10.328 1 8 1a4.53 4.53 0 0 0-2.941 1.1c-.757.652-1.153 1.438-1.153 2.055v.448l-.445.049C2.064 4.805 1 5.952 1 7.318 1 8.785 2.23 10 3.781 10H6a.5.5 0 0 1 0 1H3.781C1.708 11 0 9.366 0 7.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383"/>
                        <path fill-rule="evenodd" d="M7.646 4.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 5.707V14.5a.5.5 0 0 1-1 0V5.707L5.354 7.854a.5.5 0 1 1-.708-.708z"/>
                    </svg>
                    <h4>Drop JSON file here</h4>
                    <p class="text-muted">or click to select a file</p>
                </div>
            </div>
        </div>

        <div id="output" style="display: none;">
            <div class="json-display">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h3 class="mb-0">Data Preview</h3>
                    <div>
                        <button class="btn btn-sm btn-outline-primary me-2" id="toggleView">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye" viewBox="0 0 16 16">
                                <path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"/>
                                <path d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"/>
                            </svg>
                            Toggle View
                        </button>
                        <button class="btn btn-sm btn-primary" id="resetBtn">Load New File</button>
                    </div>
                </div>
                <div id="jsonContent"></div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        let jsonData = null;
        let viewMode = 'formatted'; // 'formatted' or 'raw'

        const dropZone = document.getElementById('dropZone');
        const fileInput = document.getElementById('fileInput');
        const output = document.getElementById('output');
        const jsonContent = document.getElementById('jsonContent');
        const toggleView = document.getElementById('toggleView');
        const resetBtn = document.getElementById('resetBtn');

        // Click to open file dialog
        dropZone.addEventListener('click', () => fileInput.click());

        // File input change
        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleFile(e.target.files[0]);
            }
        });

        // Drag and drop events
        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.classList.add('dragover');
        });

        dropZone.addEventListener('dragleave', () => {
            dropZone.classList.remove('dragover');
        });

        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('dragover');
            if (e.dataTransfer.files.length > 0) {
                handleFile(e.dataTransfer.files[0]);
            }
        });

        // Toggle between formatted and raw view
        toggleView.addEventListener('click', () => {
            viewMode = viewMode === 'formatted' ? 'raw' : 'formatted';
            displayJSON(jsonData);
        });

        // Reset button
        resetBtn.addEventListener('click', () => {
            output.style.display = 'none';
            dropZone.parentElement.parentElement.style.display = '';
            jsonData = null;
            fileInput.value = '';
        });

        function handleFile(file) {
            if (!file.name.endsWith('.json')) {
                alert('Please upload a JSON file');
                return;
            }

            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    jsonData = JSON.parse(e.target.result);
                    dropZone.parentElement.parentElement.style.display = 'none';
                    output.style.display = 'block';
                    displayJSON(jsonData);
                } catch (error) {
                    alert('Invalid JSON file: ' + error.message);
                }
            };
            reader.readAsText(file);
        }

        function displayJSON(data) {
            const filteredData = filterData(data);
            if (viewMode === 'raw') {
                jsonContent.innerHTML = `<pre>${JSON.stringify(filteredData, null, 2)}</pre>`;
            } else {
                jsonContent.innerHTML = formatJSON(filteredData);
            }
        }

        function filterData(data) {
            const fieldsToRemove = ['id', 'score', 'num_comments', 'created_utc'];
            
            if (Array.isArray(data)) {
                return data.map(item => filterData(item));
            }
            
            if (data !== null && typeof data === 'object') {
                const filtered = {};
                for (const key in data) {
                    if (!fieldsToRemove.includes(key)) {
                        filtered[key] = filterData(data[key]);
                    }
                }
                return filtered;
            }
            
            return data;
        }

        function formatJSON(data, level = 0) {
            if (data === null) {
                return `<span class="json-null">null</span>`;
            }

            const type = typeof data;
            
            if (type === 'string') {
                return `<span class="json-string">${escapeHtml(data)}</span>`;
            }
            
            if (type === 'number') {
                return `<span class="json-number">${data}</span>`;
            }
            
            if (type === 'boolean') {
                return `<span class="json-boolean">${data}</span>`;
            }

            if (Array.isArray(data)) {
                if (data.length === 0) return '<span class="text-muted">[]</span>';
                
                let html = '<div class="ms-3">';
                data.forEach((item, index) => {
                    html += `<div class="mb-2">
                        <span class="badge badge-custom me-2">${index}</span>
                        ${formatJSON(item, level + 1)}
                    </div>`;
                });
                html += '</div>';
                return html;
            }

            if (type === 'object') {
                const keys = Object.keys(data);
                if (keys.length === 0) return '<span class="text-muted">{}</span>';
                
                let html = '<div class="table-responsive"><table class="table table-hover table-sm">';
                html += '<thead><tr><th>Key</th><th>Value</th></tr></thead><tbody>';
                
                keys.forEach(key => {
                    html += `<tr>
                        <td><span class="json-key">${escapeHtml(key)}</span></td>
                        <td>${formatJSON(data[key], level + 1)}</td>
                    </tr>`;
                });
                
                html += '</tbody></table></div>';
                return html;
            }

            return String(data);
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
    </script>
</body>
</html>
